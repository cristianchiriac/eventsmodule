<dl class="rules-group-container">
    <dt class="rules-group-header">
  <div class="btn-group group-conditions" ng-if="event[model][rules].length >= 1">
      <label class="btn btn-xs btn-primary" ng-class="{active : (event[model].condition | uppercase) === 'AND', 'disabled': event[model][rules].length < 2}">
          <input type="radio" id="condition-and" name="x_cond" value="AND" ng-model="event[model].condition" ng-disabled="event[model][rules].length < 2"> AND </label>
      <label class="btn btn-xs btn-primary" ng-class="{active : (event[model].condition | uppercase) === 'OR', 'disabled': event[model][rules].length < 2}">
          <input type="radio" id="condition-or" name="x_cond" value="OR" ng-model="event[model].condition" ng-disabled="event[model][rules].length < 2"> OR </label>
  </div>
</dt>
    <dd class="rules-group-body">
        <ul class="rules-list">
            <li class="rule-container" ng-repeat="item in event[model][rules] track by $index" ng-class="{'invalid': eventForm.submitted && (eventForm[model + '_xpath_' + $index].$invalid || eventForm[model + '_operator_' + $index].$invalid || eventForm[model + '_value_' + $index].$invalid)}">
                <div class="rule-header">
                    <div class="btn-group pull-right rule-actions">
                        <a ng-click="addRule(event[model][rules])" class="btn btn-xs btn-success" ng-if="$last"><i class="glyphicon glyphicon-plus"></i> Add rule</a>
                        <a ng-click="addGroup(item, 'rules')" class="btn btn-xs btn-success" ng-if="$last"><i class="glyphicon glyphicon-plus-sign"></i> Add group</a>
                        <a class="btn btn-xs btn-danger" ng-click="remove(event[model][rules], $index)" ng-if="event[model][rules].length >1"> <i class="glyphicon glyphicon-remove"></i> Delete</a>
                    </div>
                </div>
                <div class="form-inline">
                    <div class="form-group grow" ng-class="{'invalid': eventForm[model + '_xpath_' + $index].$invalid && eventForm.submitted}">
                        <input type="text" id="{{model}}_xpath_{{$index}}" name="{{model}}_xpath_{{$index}}" class="form-control" placeholder="Xpath" ng-model="item.xpath" required>
                    </div>
                    <div class="form-group" ng-class="{'invalid': eventForm[model + '_operator_' + $index].$invalid && eventForm.submitted}">
                        <select class="form-control" name="{{model}}_operator_{{$index}}" id="{{model}}_operator_{{$index}}" ng-options="operator as operator for operator in ['EQUAL', 'NOT_EQUAL', 'CONTAINS', 'NOT_CONTAINS', 'EXISTS', 'NOT_EXISTS']" ng-model="item.operator"
                          required>
                            <option></option>
                        </select>
                    </div>
                    <div class="form-group" ng-show="item.operator !== 'EXISTS' && item.operator !== 'NOT_EXISTS'" ng-class="{'invalid': eventForm[model + '_value_' + $index].$invalid && eventForm.submitted}">
                        <input type="text" id="{{model}}_value_{{$index}}" name="{{model}}_value_{{$index}}" class="form-control" placeholder="Value" ng-model="item.value" ng-required="item.operator !== 'EXISTS' && item.operator !== 'NOT_EXISTS'" validate-condition="item">
                    </div>
                </div>
                <!-- <source ng-if="item.rules" model="'item'"></source> -->
                <div ng-repeat="subitem in item.rules">
                    <dd class="rules-group-body">
                        <ul class="rules-list">
                            <li class="rule-container" ng-repeat="item in event[model][rules] track by $index" ng-class="{'invalid': eventForm.submitted && (eventForm[model + '_xpath_' + $index].$invalid || eventForm[model + '_operator_' + $index].$invalid || eventForm[model + '_value_' + $index].$invalid)}">
                                <div class="rule-header">
                                    <div class="btn-group pull-right rule-actions">
                                        <a ng-click="addRule(event[model][rules])" class="btn btn-xs btn-success" ng-if="$last"><i class="glyphicon glyphicon-plus"></i> Add rule</a>
                                        <a ng-click="addGroup(item, 'rules')" class="btn btn-xs btn-success" ng-if="$last"><i class="glyphicon glyphicon-plus-sign"></i> Add group</a>
                                        <a class="btn btn-xs btn-danger" ng-click="remove(event[model][rules], $index)" ng-if="event[model][rules].length >1"> <i class="glyphicon glyphicon-remove"></i> Delete</a>
                                    </div>
                                </div>
                                <div class="form-inline">
                                    <div class="form-group grow" ng-class="{'invalid': eventForm[model + '_xpath_' + $index].$invalid && eventForm.submitted}">
                                        <input type="text" id="{{model}}_xpath_{{$index}}" name="{{model}}_xpath_{{$index}}" class="form-control" placeholder="Xpath" ng-model="item.xpath" required>
                                    </div>
                                    <div class="form-group" ng-class="{'invalid': eventForm[model + '_operator_' + $index].$invalid && eventForm.submitted}">
                                        <select class="form-control" name="{{model}}_operator_{{$index}}" id="{{model}}_operator_{{$index}}" ng-options="operator as operator for operator in ['EQUAL', 'NOT_EQUAL', 'CONTAINS', 'NOT_CONTAINS', 'EXISTS', 'NOT_EXISTS']" ng-model="item.operator"
                                          required>
                                            <option></option>
                                        </select>
                                    </div>
                                    <div class="form-group" ng-show="item.operator !== 'EXISTS' && item.operator !== 'NOT_EXISTS'" ng-class="{'invalid': eventForm[model + '_value_' + $index].$invalid && eventForm.submitted}">
                                        <input type="text" id="{{model}}_value_{{$index}}" name="{{model}}_value_{{$index}}" class="form-control" placeholder="Value" ng-model="item.value" ng-required="item.operator !== 'EXISTS' && item.operator !== 'NOT_EXISTS'" validate-condition="item">
                                    </div>
                                </div>
                                <!-- <source ng-if="item.rules" model="'item'"></source> -->
                                <div ng-repeat="subitem in item.rules">
                                    <source ng-if="subitem.rules" model="subitem"></source>
                                </div>
                            </li>
                        </ul>
                    </dd>
                </div>
            </li>
        </ul>
    </dd>
</dl>